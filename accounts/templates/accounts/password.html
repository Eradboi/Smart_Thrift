{% extends 'accounts/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Smart Thrift | Edit Profile {% endblock %}</title>
    <style>
        .contents {
            display: grid;
            place-items: center;
            margin-left: auto;
            margin-right: auto;
            padding: 10px;
            width: 90%;
            border-radius: 7px;

            backdrop-filter: blur(10px);
            box-shadow: 0px 0px 3px black;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            /* Set the body height to 100% of the viewport height */
        }

        .contents:hover {
            box-shadow: 0px 0px 5px black;
        }

        .alert {
            overflow: hidden;
            max-width: 150px;
        }

        .image-box {
            margin-top: 10px;
            margin-bottom: 10px;
            border-radius: 25px;
            border: rgb(236, 240, 248) solid 1px;
            padding: 10px;
        }

        .box {
            overflow: auto;
        }

        .profilepic__box {
            position: relative;
            opacity: 0.75;
        }

        .profilepic__box:hover {
            opacity: 0.4;
            transition: opacity 0.5s ease-in-out;
        }

        .profilepic__content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: black;
            background: transparent;
            backdrop-filter: blur(2px);
            padding: 3px;
            border-radius: 2px;

        }

        .profilepic__content:hover {
            color: rgb(6, 190, 247);
            transition: 0.5s ease-in-out;
        }

        .a-tag {
            text-decoration: none;
            font-weight: 500;
            color: black;
            max-width: max-content;

        }

        .profile-image {
            width: 100%;
            /* Set the width to 100% to scale the image to the width of its container */
            max-width: 200px;
            /* Set a maximum width to prevent the image from becoming too large */
            height: auto;
            /* Allow the height to adjust automatically based on the aspect ratio */
            border-radius: 50%;
            /* Apply a rounded shape for a circular profile picture */
            backdrop-filter: blur(2px);
        }
    </style>
</head>

<body>
    {% for message in messages %}
    {% if message.tags == "error" %}
    <div class="toast show">
        <div class="toast-header">
            Notification
            <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body">
            {{ message }}
        </div>
    </div>
    {% endif %}
    {% endfor %}

    <div class="contents">
        <h2>Edit Profile</h2>
        <div class="profilepic__box">
            {% if picture %}
            {% for pic in picture %}
            {% if pic.user == request.user %}
            <img src="{{ pic.image.url }}" alt="profile pic" class="rounded-circle img-fluid profile-image"
                id="profile-image" style="width: 200px; height: 200px;">
            {% endif %}
            {% endfor %}
            {% else %}
            <img src="https://uxwing.com/wp-content/themes/uxwing/download/peoples-avatars/no-profile-picture-icon.png"
                alt="profile pic" class="rounded-circle img-fluid profile-image" style="width: 200px; height: 200px;">
            {% endif %}
            <div class="profilepic__content">
                <a href="{% url 'editpicture' %}" class="a-tag">
                    <span class="profilepic__icon"><i class="fas fa-camera"></i></span>
                    <span class="profilepic__text">Edit Profile Picture</span>
                </a>

            </div>
        </div>
        <form method="POST" action="{% url 'editprofile' %}">
            {% csrf_token %}

            <label for="{{ form.username.id_for_label }}">Username</label>
            <div>{{ form.username }}
                <br>
                {% if form.username.errors %}
                {% for error in form.username.errors %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    <small>{{ error }}</small>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
                {% endif %}
            </div>
            <label for="{{ form.email.id_for_label }}">Email</label>
            <div>{{ form.email }}</div>
            <br>

            <label for="{{ form.category.id_for_label }}">Category</label>
            <div>{{ form.category }}</div>
            <br>
            <label for="{{ form.phone.id_for_label }}">Phone Number</label>
            <div>{{ form.phone }}</div>
            <br>
            {% if form.phone.errors %}
            {% for error in form.phone.errors %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <small>{{ error }}</small>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
            {% endif %}
            <button class="btn btn-primary">Save Details</button>
        </form>
        <br>
        <a href="{% url 'password_reset' %}"><i class="fa-solid fa-unlock" style="color: rgb(0, 60, 255);"></i> Change
            Password</a>
    </div>

</body>

</html>
{% endblock %}